
name: aws_sec_lake_s3_data
author: Antimatter
description: "Recommended preset for processing AWS Security Lake `S3 DataEvents`"
autoloader:
  format: parquet
  cloudFiles:
    schemaHints: "activity_id INT,activity_name STRING,actor STRUCT<app_name:STRING,app_uid:STRING,authorizations:ARRAY<STRUCT<decision:STRING,policy:STRUCT<desc:STRING,group:STRUCT<desc:STRING,domain:STRING,name:STRING,privileges:ARRAY<STRING>,type:STRING,uid:STRING>,is_applied:BOOLEAN,name:STRING,uid:STRING,version:STRING>>>,idp:STRUCT<name:STRING,uid:STRING>,invoked_by:STRING,process:STRUCT<auid:INT,cmd_line:STRING,container:STRUCT<hash:STRUCT<algorithm:STRING,algorithm_id:INT,value:STRING>,image:STRUCT<labels:ARRAY<STRING>,name:STRING,path:STRING,tag:STRING,uid:STRING>,name:STRING,network_driver:STRING,orchestrator:STRING,pod_uuid:STRING,runtime:STRING,size:BIGINT,tag:STRING,uid:STRING>,created_time:TIMESTAMP,created_time_dt:TIMESTAMP,egid:INT,euid:INT,file:STRUCT<accessed_time:TIMESTAMP,accessed_time_dt:TIMESTAMP,accessor:STRUCT<account:STRUCT<labels:ARRAY<STRING>,name:STRING,type:STRING,type_id:INT,uid:STRING>,credential_uid:STRING,domain:STRING,email_addr:STRING,full_name:STRING,groups:ARRAY<STRUCT<desc:STRING,domain:STRING,name:STRING,privileges:ARRAY<STRING>,type:STRING,uid:STRING>>,ldap_person:STRUCT<cost_center:STRING,created_time:TIMESTAMP,created_time_dt:TIMESTAMP,deleted_time:TIMESTAMP,deleted_time_dt:TIMESTAMP,email_addrs:ARRAY<STRING>,employee_uid:STRING,given_name:STRING,hire_time:TIMESTAMP,hire_time_dt:TIMESTAMP,job_title:STRING,labels:ARRAY<STRING>,last_login_time:TIMESTAMP,last_login_time_dt:TIMESTAMP,ldap_cn:STRING,ldap_dn:STRING,leave_time:TIMESTAMP,leave_time_dt:TIMESTAMP,location:STRUCT<city:STRING,continent:STRING,coordinates:ARRAY<FLOAT>,country:STRING,desc:STRING,geohash:STRING,is_on_premises:BOOLEAN,isp:STRING,lat:FLOAT,long:FLOAT,postal_code:STRING,provider:STRING,region:STRING>,manager:VARIANT,modified_time:TIMESTAMP,modified_time_dt:TIMESTAMP,office_location:STRING,surname:STRING>,name:STRING,org:STRUCT<name:STRING,ou_name:STRING,ou_uid:STRING,uid:STRING>,risk_level:STRING,risk_level_id:INT,risk_score:INT,type:STRING,type_id:INT,uid:STRING,uid_alt:STRING>,attributes:INT,company_name:STRING,confidentiality:STRING,confidentiality_id:INT,created_time:TIMESTAMP,created_time_dt:TIMESTAMP,creator:STRUCT<account:STRUCT<labels:ARRAY<STRING>,name:STRING,type:STRING,type_id:INT,uid:STRING>,credential_uid:STRING,domain:STRING,email_addr:STRING,full_name:STRING,groups:ARRAY<STRUCT<desc:STRING,domain:STRING,name:STRING,privileges:ARRAY<STRING>,type:STRING,uid:STRING>>,ldap_person:STRUCT<cost_center:STRING,created_time:TIMESTAMP,created_time_dt:TIMESTAMP,deleted_time:TIMESTAMP,deleted_time_dt:TIMESTAMP,email_addrs:ARRAY<STRING>,employee_uid:STRING,given_name:STRING,hire_time:TIMESTAMP,hire_time_dt:TIMESTAMP,job_title:STRING,labels:ARRAY<STRING>,last_login_time:TIMESTAMP,last_login_time_dt:TIMESTAMP,ldap_cn:STRING,ldap_dn:STRING,leave_time:TIMESTAMP,leave_time_dt:TIMESTAMP,location:STRUCT<city:STRING,continent:STRING,coordinates:ARRAY<FLOAT>,country:STRING,desc:STRING,geohash:STRING,is_on_premises:BOOLEAN,isp:STRING,lat:FLOAT,long:FLOAT,postal_code:STRING,provider:STRING,region:STRING>,manager:VARIANT,modified_time:TIMESTAMP,modified_time_dt:TIMESTAMP,office_location:STRING,surname:STRING>,name:STRING,org:STRUCT<name:STRING,ou_name:STRING,ou_uid:STRING,uid:STRING>,risk_level:STRING,risk_level_id:INT,risk_score:INT,type:STRING,type_id:INT,uid:STRING,uid_alt:STRING>,data_classification:STRUCT<category:STRING,category_id:INT,confidentiality:STRING,confidentiality_id:INT,policy:STRUCT<desc:STRING,group:STRUCT<desc:STRING,domain:STRING,name:STRING,privileges:ARRAY<STRING>,type:STRING,uid:STRING>,is_applied:BOOLEAN,name:STRING,uid:STRING,version:STRING>>,desc:STRING,ext:STRING,hashes:ARRAY<STRUCT<algorithm:STRING,algorithm_id:INT,value:STRING>>,is_system:BOOLEAN,mime_type:STRING,modified_time:TIMESTAMP,modified_time_dt:TIMESTAMP,modifier:STRUCT<account:STRUCT<labels:ARRAY<STRING>,name:STRING,type:STRING,type_id:INT,uid:STRING>,credential_uid:STRING,domain:STRING,email_addr:STRING,full_name:STRING,groups:ARRAY<STRUCT<desc:STRING,domain:STRING,name:STRING,privileges:ARRAY<STRING>,type:STRING,uid:STRING>>,ldap_person:STRUCT<cost_center:STRING,created_time:TIMESTAMP,created_time_dt:TIMESTAMP,deleted_time:TIMESTAMP,deleted_time_dt:TIMESTAMP,email_addrs:ARRAY<STRING>,employee_uid:STRING,given_name:STRING,hire_time:TIMESTAMP,hire_time_dt:TIMESTAMP,job_title:STRING,labels:ARRAY<STRING>,last_login_time:TIMESTAMP,last_login_time_dt:TIMESTAMP,ldap_cn:STRING,ldap_dn:STRING,leave_time:TIMESTAMP,leave_time_dt:TIMESTAMP,location:STRUCT<city:STRING,continent:STRING,coordinates:ARRAY<FLOAT>,country:STRING,desc:STRING,geohash:STRING,is_on_premises:BOOLEAN,isp:STRING,lat:FLOAT,long:FLOAT,postal_code:STRING,provider:STRING,region:STRING>,manager:VARIANT,modified_time:TIMESTAMP,modified_time_dt:TIMESTAMP,office_location:STRING,surname:STRING>,name:STRING,org:STRUCT<name:STRING,ou_name:STRING,ou_uid:STRING,uid:STRING>,risk_level:STRING,risk_level_id:INT,risk_score:INT,type:STRING,type_id:INT,uid:STRING,uid_alt:STRING>,name:STRING,owner:STRUCT<account:STRUCT<labels:ARRAY<STRING>,name:STRING,type:STRING,type_id:INT,uid:STRING>,credential_uid:STRING,domain:STRING,email_addr:STRING,full_name:STRING,groups:ARRAY<STRUCT<desc:STRING,domain:STRING,name:STRING,privileges:ARRAY<STRING>,type:STRING,uid:STRING>>,ldap_person:STRUCT<cost_center:STRING,created_time:TIMESTAMP,created_time_dt:TIMESTAMP,deleted_time:TIMESTAMP,deleted_time_dt:TIMESTAMP,email_addrs:ARRAY<STRING>,employee_uid:STRING,given_name:STRING,hire_time:TIMESTAMP,hire_time_dt:TIMESTAMP,job_title:STRING,labels:ARRAY<STRING>,last_login_time:TIMESTAMP,last_login_time_dt:TIMESTAMP,ldap_cn:STRING,ldap_dn:STRING,leave_time:TIMESTAMP,leave_time_dt:TIMESTAMP,location:STRUCT<city:STRING,continent:STRING,coordinates:ARRAY<FLOAT>,country:STRING,desc:STRING,geohash:STRING,is_on_premises:BOOLEAN,isp:STRING,lat:FLOAT,long:FLOAT,postal_code:STRING,provider:STRING,region:STRING>,manager:VARIANT,modified_time:TIMESTAMP,modified_time_dt:TIMESTAMP,office_location:STRING,surname:STRING>,name:STRING,org:STRUCT<name:STRING,ou_name:STRING,ou_uid:STRING,uid:STRING>,risk_level:STRING,risk_level_id:INT,risk_score:INT,type:STRING,type_id:INT,uid:STRING,uid_alt:STRING>,parent_folder:STRING,path:STRING,product:STRUCT<cpe_name:STRING,data_classification:STRUCT<category:STRING,category_id:INT,confidentiality:STRING,confidentiality_id:INT,policy:STRUCT<desc:STRING,group:STRUCT<desc:STRING,domain:STRING,name:STRING,privileges:ARRAY<STRING>,type:STRING,uid:STRING>,is_applied:BOOLEAN,name:STRING,uid:STRING,version:STRING>>,feature:STRUCT<name:STRING,uid:STRING,version:STRING>,lang:STRING,name:STRING,path:STRING,uid:STRING,url_string:STRING,vendor_name:STRING,version:STRING>,security_descriptor:STRING,signature:STRUCT<algorithm:STRING,algorithm_id:INT,certificate:STRUCT<created_time:TIMESTAMP,created_time_dt:TIMESTAMP,expiration_time:TIMESTAMP,expiration_time_dt:TIMESTAMP,fingerprints:ARRAY<STRUCT<algorithm:STRING,algorithm_id:INT,value:STRING>>,is_self_signed:BOOLEAN,issuer:STRING,serial_number:STRING,subject:STRING,uid:STRING,version:STRING>,created_time:TIMESTAMP,created_time_dt:TIMESTAMP,developer_uid:STRING,digest:STRUCT<algorithm:STRING,algorithm_id:INT,value:STRING>,state:STRING,state_id:INT>,size:BIGINT,type:STRING,type_id:INT,uid:STRING,version:STRING,xattributes:VARIANT>,group:STRUCT<desc:STRING,domain:STRING,name:STRING,privileges:ARRAY<STRING>,type:STRING,uid:STRING>,integrity:STRING,integrity_id:INT,lineage:ARRAY<STRING>,loaded_modules:ARRAY<STRING>,name:STRING,namespace_pid:INT,parent_process:VARIANT,pid:INT,sandbox:STRING,session:STRUCT<count:INT,created_time:TIMESTAMP,created_time_dt:TIMESTAMP,credential_uid:STRING,expiration_reason:STRING,expiration_time:TIMESTAMP,expiration_time_dt:TIMESTAMP,is_mfa:BOOLEAN,is_remote:BOOLEAN,is_vpn:BOOLEAN,issuer:STRING,terminal:STRING,uid:STRING,uid_alt:STRING,uuid:STRING>,terminated_time:TIMESTAMP,terminated_time_dt:TIMESTAMP,tid:INT,uid:STRING,user:STRUCT<account:STRUCT<labels:ARRAY<STRING>,name:STRING,type:STRING,type_id:INT,uid:STRING>,credential_uid:STRING,domain:STRING,email_addr:STRING,full_name:STRING,groups:ARRAY<STRUCT<desc:STRING,domain:STRING,name:STRING,privileges:ARRAY<STRING>,type:STRING,uid:STRING>>,ldap_person:STRUCT<cost_center:STRING,created_time:TIMESTAMP,created_time_dt:TIMESTAMP,deleted_time:TIMESTAMP,deleted_time_dt:TIMESTAMP,email_addrs:ARRAY<STRING>,employee_uid:STRING,given_name:STRING,hire_time:TIMESTAMP,hire_time_dt:TIMESTAMP,job_title:STRING,labels:ARRAY<STRING>,last_login_time:TIMESTAMP,last_login_time_dt:TIMESTAMP,ldap_cn:STRING,ldap_dn:STRING,leave_time:TIMESTAMP,leave_time_dt:TIMESTAMP,location:STRUCT<city:STRING,continent:STRING,coordinates:ARRAY<FLOAT>,country:STRING,desc:STRING,geohash:STRING,is_on_premises:BOOLEAN,isp:STRING,lat:FLOAT,long:FLOAT,postal_code:STRING,provider:STRING,region:STRING>,manager:VARIANT,modified_time:TIMESTAMP,modified_time_dt:TIMESTAMP,office_location:STRING,surname:STRING>,name:STRING,org:STRUCT<name:STRING,ou_name:STRING,ou_uid:STRING,uid:STRING>,risk_level:STRING,risk_level_id:INT,risk_score:INT,type:STRING,type_id:INT,uid:STRING,uid_alt:STRING>,xattributes:VARIANT>,session:STRUCT<count:INT,created_time:TIMESTAMP,created_time_dt:TIMESTAMP,credential_uid:STRING,expiration_reason:STRING,expiration_time:TIMESTAMP,expiration_time_dt:TIMESTAMP,is_mfa:BOOLEAN,is_remote:BOOLEAN,is_vpn:BOOLEAN,issuer:STRING,terminal:STRING,uid:STRING,uid_alt:STRING,uuid:STRING>,user:STRUCT<account:STRUCT<labels:ARRAY<STRING>,name:STRING,type:STRING,type_id:INT,uid:STRING>,credential_uid:STRING,domain:STRING,email_addr:STRING,full_name:STRING,groups:ARRAY<STRUCT<desc:STRING,domain:STRING,name:STRING,privileges:ARRAY<STRING>,type:STRING,uid:STRING>>,ldap_person:STRUCT<cost_center:STRING,created_time:TIMESTAMP,created_time_dt:TIMESTAMP,deleted_time:TIMESTAMP,deleted_time_dt:TIMESTAMP,email_addrs:ARRAY<STRING>,employee_uid:STRING,given_name:STRING,hire_time:TIMESTAMP,hire_time_dt:TIMESTAMP,job_title:STRING,labels:ARRAY<STRING>,last_login_time:TIMESTAMP,last_login_time_dt:TIMESTAMP,ldap_cn:STRING,ldap_dn:STRING,leave_time:TIMESTAMP,leave_time_dt:TIMESTAMP,location:STRUCT<city:STRING,continent:STRING,coordinates:ARRAY<FLOAT>,country:STRING,desc:STRING,geohash:STRING,is_on_premises:BOOLEAN,isp:STRING,lat:FLOAT,long:FLOAT,postal_code:STRING,provider:STRING,region:STRING>,manager:VARIANT,modified_time:TIMESTAMP,modified_time_dt:TIMESTAMP,office_location:STRING,surname:STRING>,name:STRING,org:STRUCT<name:STRING,ou_name:STRING,ou_uid:STRING,uid:STRING>,risk_level:STRING,risk_level_id:INT,risk_score:INT,type:STRING,type_id:INT,uid:STRING,uid_alt:STRING>>,api STRUCT<group:STRUCT<desc:STRING,domain:STRING,name:STRING,privileges:ARRAY<STRING>,type:STRING,uid:STRING>,operation:STRING,request:STRUCT<containers:ARRAY<STRUCT<hash:STRUCT<algorithm:STRING,algorithm_id:INT,value:STRING>,image:STRUCT<labels:ARRAY<STRING>,name:STRING,path:STRING,tag:STRING,uid:STRING>,name:STRING,network_driver:STRING,orchestrator:STRING,pod_uuid:STRING,runtime:STRING,size:BIGINT,tag:STRING,uid:STRING>>,data:VARIANT,flags:ARRAY<STRING>,uid:STRING>,response:STRUCT<code:INT,containers:ARRAY<STRUCT<hash:STRUCT<algorithm:STRING,algorithm_id:INT,value:STRING>,image:STRUCT<labels:ARRAY<STRING>,name:STRING,path:STRING,tag:STRING,uid:STRING>,name:STRING,network_driver:STRING,orchestrator:STRING,pod_uuid:STRING,runtime:STRING,size:BIGINT,tag:STRING,uid:STRING>>,data:VARIANT,error:STRING,error_message:STRING,flags:ARRAY<STRING>,message:STRING>,service:STRUCT<labels:ARRAY<STRING>,name:STRING,uid:STRING,version:STRING>,version:STRING>,category_name STRING,category_uid INT,class_name STRING,class_uid INT,cloud STRUCT<account:STRUCT<labels:ARRAY<STRING>,name:STRING,type:STRING,type_id:INT,uid:STRING>,org:STRUCT<name:STRING,ou_name:STRING,ou_uid:STRING,uid:STRING>,project_uid:STRING,provider:STRING,region:STRING,zone:STRING>,count INT,dst_endpoint STRUCT<agent_list:ARRAY<STRUCT<name:STRING,policies:ARRAY<STRUCT<desc:STRING,group:STRUCT<desc:STRING,domain:STRING,name:STRING,privileges:ARRAY<STRING>,type:STRING,uid:STRING>,is_applied:BOOLEAN,name:STRING,uid:STRING,version:STRING>>,type:STRING,type_id:INT,uid:STRING,uid_alt:STRING,vendor_name:STRING,version:STRING>>,autonomous_system:STRUCT<name:STRING,number:INT>,container:STRUCT<hash:STRUCT<algorithm:STRING,algorithm_id:INT,value:STRING>,image:STRUCT<labels:ARRAY<STRING>,name:STRING,path:STRING,tag:STRING,uid:STRING>,name:STRING,network_driver:STRING,orchestrator:STRING,pod_uuid:STRING,runtime:STRING,size:BIGINT,tag:STRING,uid:STRING>,domain:STRING,hostname:STRING,hw_info:STRUCT<bios_date:STRING,bios_manufacturer:STRING,bios_ver:STRING,chassis:STRING,cpu_bits:INT,cpu_cores:INT,cpu_count:INT,cpu_speed:INT,cpu_type:STRING,desktop_display:STRUCT<color_depth:INT,physical_height:INT,physical_orientation:INT,physical_width:INT,scale_factor:INT>,keyboard_info:STRUCT<function_keys:INT,ime:STRING,keyboard_layout:STRING,keyboard_subtype:INT,keyboard_type:STRING>,ram_size:INT,serial_number:STRING>,instance_uid:STRING,interface_name:STRING,interface_uid:STRING,intermediate_ips:ARRAY<STRING>,ip:STRING,location:STRUCT<city:STRING,continent:STRING,coordinates:ARRAY<FLOAT>,country:STRING,desc:STRING,geohash:STRING,is_on_premises:BOOLEAN,isp:STRING,lat:FLOAT,long:FLOAT,postal_code:STRING,provider:STRING,region:STRING>,mac:STRING,name:STRING,namespace_pid:INT,os:STRUCT<build:STRING,country:STRING,cpe_name:STRING,cpu_bits:INT,edition:STRING,lang:STRING,name:STRING,sp_name:STRING,sp_ver:INT,type:STRING,type_id:INT,version:STRING>,owner:STRUCT<account:STRUCT<labels:ARRAY<STRING>,name:STRING,type:STRING,type_id:INT,uid:STRING>,credential_uid:STRING,domain:STRING,email_addr:STRING,full_name:STRING,groups:ARRAY<STRUCT<desc:STRING,domain:STRING,name:STRING,privileges:ARRAY<STRING>,type:STRING,uid:STRING>>,ldap_person:STRUCT<cost_center:STRING,created_time:TIMESTAMP,created_time_dt:TIMESTAMP,deleted_time:TIMESTAMP,deleted_time_dt:TIMESTAMP,email_addrs:ARRAY<STRING>,employee_uid:STRING,given_name:STRING,hire_time:TIMESTAMP,hire_time_dt:TIMESTAMP,job_title:STRING,labels:ARRAY<STRING>,last_login_time:TIMESTAMP,last_login_time_dt:TIMESTAMP,ldap_cn:STRING,ldap_dn:STRING,leave_time:TIMESTAMP,leave_time_dt:TIMESTAMP,location:STRUCT<city:STRING,continent:STRING,coordinates:ARRAY<FLOAT>,country:STRING,desc:STRING,geohash:STRING,is_on_premises:BOOLEAN,isp:STRING,lat:FLOAT,long:FLOAT,postal_code:STRING,provider:STRING,region:STRING>,manager:VARIANT,modified_time:TIMESTAMP,modified_time_dt:TIMESTAMP,office_location:STRING,surname:STRING>,name:STRING,org:STRUCT<name:STRING,ou_name:STRING,ou_uid:STRING,uid:STRING>,risk_level:STRING,risk_level_id:INT,risk_score:INT,type:STRING,type_id:INT,uid:STRING,uid_alt:STRING>,port:INT,proxy_endpoint:STRUCT<agent_list:ARRAY<STRUCT<name:STRING,policies:ARRAY<STRUCT<desc:STRING,group:STRUCT<desc:STRING,domain:STRING,name:STRING,privileges:ARRAY<STRING>,type:STRING,uid:STRING>,is_applied:BOOLEAN,name:STRING,uid:STRING,version:STRING>>,type:STRING,type_id:INT,uid:STRING,uid_alt:STRING,vendor_name:STRING,version:STRING>>,autonomous_system:STRUCT<name:STRING,number:INT>,container:STRUCT<hash:STRUCT<algorithm:STRING,algorithm_id:INT,value:STRING>,image:STRUCT<labels:ARRAY<STRING>,name:STRING,path:STRING,tag:STRING,uid:STRING>,name:STRING,network_driver:STRING,orchestrator:STRING,pod_uuid:STRING,runtime:STRING,size:BIGINT,tag:STRING,uid:STRING>,domain:STRING,hostname:STRING,hw_info:STRUCT<bios_date:STRING,bios_manufacturer:STRING,bios_ver:STRING,chassis:STRING,cpu_bits:INT,cpu_cores:INT,cpu_count:INT,cpu_speed:INT,cpu_type:STRING,desktop_display:STRUCT<color_depth:INT,physical_height:INT,physical_orientation:INT,physical_width:INT,scale_factor:INT>,keyboard_info:STRUCT<function_keys:INT,ime:STRING,keyboard_layout:STRING,keyboard_subtype:INT,keyboard_type:STRING>,ram_size:INT,serial_number:STRING>,instance_uid:STRING,interface_name:STRING,interface_uid:STRING,intermediate_ips:ARRAY<STRING>,ip:STRING,location:STRUCT<city:STRING,continent:STRING,coordinates:ARRAY<FLOAT>,country:STRING,desc:STRING,geohash:STRING,is_on_premises:BOOLEAN,isp:STRING,lat:FLOAT,long:FLOAT,postal_code:STRING,provider:STRING,region:STRING>,mac:STRING,name:STRING,namespace_pid:INT,os:STRUCT<build:STRING,country:STRING,cpe_name:STRING,cpu_bits:INT,edition:STRING,lang:STRING,name:STRING,sp_name:STRING,sp_ver:INT,type:STRING,type_id:INT,version:STRING>,owner:STRUCT<account:STRUCT<labels:ARRAY<STRING>,name:STRING,type:STRING,type_id:INT,uid:STRING>,credential_uid:STRING,domain:STRING,email_addr:STRING,full_name:STRING,groups:ARRAY<STRUCT<desc:STRING,domain:STRING,name:STRING,privileges:ARRAY<STRING>,type:STRING,uid:STRING>>,ldap_person:STRUCT<cost_center:STRING,created_time:TIMESTAMP,created_time_dt:TIMESTAMP,deleted_time:TIMESTAMP,deleted_time_dt:TIMESTAMP,email_addrs:ARRAY<STRING>,employee_uid:STRING,given_name:STRING,hire_time:TIMESTAMP,hire_time_dt:TIMESTAMP,job_title:STRING,labels:ARRAY<STRING>,last_login_time:TIMESTAMP,last_login_time_dt:TIMESTAMP,ldap_cn:STRING,ldap_dn:STRING,leave_time:TIMESTAMP,leave_time_dt:TIMESTAMP,location:STRUCT<city:STRING,continent:STRING,coordinates:ARRAY<FLOAT>,country:STRING,desc:STRING,geohash:STRING,is_on_premises:BOOLEAN,isp:STRING,lat:FLOAT,long:FLOAT,postal_code:STRING,provider:STRING,region:STRING>,manager:VARIANT,modified_time:TIMESTAMP,modified_time_dt:TIMESTAMP,office_location:STRING,surname:STRING>,name:STRING,org:STRUCT<name:STRING,ou_name:STRING,ou_uid:STRING,uid:STRING>,risk_level:STRING,risk_level_id:INT,risk_score:INT,type:STRING,type_id:INT,uid:STRING,uid_alt:STRING>,port:INT,proxy_endpoint:VARIANT,subnet_uid:STRING,svc_name:STRING,type:STRING,type_id:INT,uid:STRING,vlan_uid:STRING,vpc_uid:STRING,zone:STRING>,subnet_uid:STRING,svc_name:STRING,type:STRING,type_id:INT,uid:STRING,vlan_uid:STRING,vpc_uid:STRING,zone:STRING>,duration BIGINT,end_time TIMESTAMP,end_time_dt TIMESTAMP,enrichments ARRAY<STRUCT<created_time:TIMESTAMP,created_time_dt:TIMESTAMP,data:VARIANT,desc:STRING,name:STRING,provider:STRING,reputation:STRUCT<base_score:FLOAT,provider:STRING,score:STRING,score_id:INT>,short_desc:STRING,src_url:STRING,type:STRING,value:STRING>>,http_request STRUCT<args:STRING,http_headers:ARRAY<STRUCT<name:STRING,value:STRING>>,http_method:STRING,length:INT,referrer:STRING,uid:STRING,url:STRUCT<categories:ARRAY<STRING>,category_ids:ARRAY<INT>,domain:STRING,hostname:STRING,path:STRING,port:INT,query_string:STRING,resource_type:STRING,scheme:STRING,subdomain:STRING,url_string:STRING>,user_agent:STRING,version:STRING,x_forwarded_for:ARRAY<STRING>>,message STRING,metadata STRUCT<correlation_uid:STRING,data_classification:STRUCT<category:STRING,category_id:INT,confidentiality:STRING,confidentiality_id:INT,policy:STRUCT<desc:STRING,group:STRUCT<desc:STRING,domain:STRING,name:STRING,privileges:ARRAY<STRING>,type:STRING,uid:STRING>,is_applied:BOOLEAN,name:STRING,uid:STRING,version:STRING>>,event_code:STRING,extension:STRUCT<name:STRING,uid:STRING,version:STRING>,extensions:ARRAY<STRUCT<name:STRING,uid:STRING,version:STRING>>,labels:ARRAY<STRING>,log_level:STRING,log_name:STRING,log_provider:STRING,log_version:STRING,logged_time:TIMESTAMP,logged_time_dt:TIMESTAMP,loggers:ARRAY<STRUCT<device:STRUCT<agent_list:ARRAY<STRUCT<name:STRING,policies:ARRAY<STRUCT<desc:STRING,group:STRUCT<desc:STRING,domain:STRING,name:STRING,privileges:ARRAY<STRING>,type:STRING,uid:STRING>,is_applied:BOOLEAN,name:STRING,uid:STRING,version:STRING>>,type:STRING,type_id:INT,uid:STRING,uid_alt:STRING,vendor_name:STRING,version:STRING>>,autoscale_uid:STRING,boot_time:TIMESTAMP,boot_time_dt:TIMESTAMP,container:STRUCT<hash:STRUCT<algorithm:STRING,algorithm_id:INT,value:STRING>,image:STRUCT<labels:ARRAY<STRING>,name:STRING,path:STRING,tag:STRING,uid:STRING>,name:STRING,network_driver:STRING,orchestrator:STRING,pod_uuid:STRING,runtime:STRING,size:BIGINT,tag:STRING,uid:STRING>,created_time:TIMESTAMP,created_time_dt:TIMESTAMP,desc:STRING,domain:STRING,first_seen_time:TIMESTAMP,first_seen_time_dt:TIMESTAMP,groups:ARRAY<STRUCT<desc:STRING,domain:STRING,name:STRING,privileges:ARRAY<STRING>,type:STRING,uid:STRING>>,hostname:STRING,hw_info:STRUCT<bios_date:STRING,bios_manufacturer:STRING,bios_ver:STRING,chassis:STRING,cpu_bits:INT,cpu_cores:INT,cpu_count:INT,cpu_speed:INT,cpu_type:STRING,desktop_display:STRUCT<color_depth:INT,physical_height:INT,physical_orientation:INT,physical_width:INT,scale_factor:INT>,keyboard_info:STRUCT<function_keys:INT,ime:STRING,keyboard_layout:STRING,keyboard_subtype:INT,keyboard_type:STRING>,ram_size:INT,serial_number:STRING>,hypervisor:STRING,image:STRUCT<labels:ARRAY<STRING>,name:STRING,path:STRING,tag:STRING,uid:STRING>,imei:STRING,instance_uid:STRING,interface_name:STRING,interface_uid:STRING,ip:STRING,is_compliant:BOOLEAN,is_managed:BOOLEAN,is_personal:BOOLEAN,is_trusted:BOOLEAN,last_seen_time:TIMESTAMP,last_seen_time_dt:TIMESTAMP,location:STRUCT<city:STRING,continent:STRING,coordinates:ARRAY<FLOAT>,country:STRING,desc:STRING,geohash:STRING,is_on_premises:BOOLEAN,isp:STRING,lat:FLOAT,long:FLOAT,postal_code:STRING,provider:STRING,region:STRING>,mac:STRING,modified_time:TIMESTAMP,modified_time_dt:TIMESTAMP,name:STRING,namespace_pid:INT,network_interfaces:ARRAY<STRUCT<hostname:STRING,ip:STRING,mac:STRING,name:STRING,namespace:STRING,subnet_prefix:INT,type:STRING,type_id:INT,uid:STRING>>,org:STRUCT<name:STRING,ou_name:STRING,ou_uid:STRING,uid:STRING>,os:STRUCT<build:STRING,country:STRING,cpe_name:STRING,cpu_bits:INT,edition:STRING,lang:STRING,name:STRING,sp_name:STRING,sp_ver:INT,type:STRING,type_id:INT,version:STRING>,owner:STRUCT<account:STRUCT<labels:ARRAY<STRING>,name:STRING,type:STRING,type_id:INT,uid:STRING>,credential_uid:STRING,domain:STRING,email_addr:STRING,full_name:STRING,groups:ARRAY<STRUCT<desc:STRING,domain:STRING,name:STRING,privileges:ARRAY<STRING>,type:STRING,uid:STRING>>,ldap_person:STRUCT<cost_center:STRING,created_time:TIMESTAMP,created_time_dt:TIMESTAMP,deleted_time:TIMESTAMP,deleted_time_dt:TIMESTAMP,email_addrs:ARRAY<STRING>,employee_uid:STRING,given_name:STRING,hire_time:TIMESTAMP,hire_time_dt:TIMESTAMP,job_title:STRING,labels:ARRAY<STRING>,last_login_time:TIMESTAMP,last_login_time_dt:TIMESTAMP,ldap_cn:STRING,ldap_dn:STRING,leave_time:TIMESTAMP,leave_time_dt:TIMESTAMP,location:STRUCT<city:STRING,continent:STRING,coordinates:ARRAY<FLOAT>,country:STRING,desc:STRING,geohash:STRING,is_on_premises:BOOLEAN,isp:STRING,lat:FLOAT,long:FLOAT,postal_code:STRING,provider:STRING,region:STRING>,manager:VARIANT,modified_time:TIMESTAMP,modified_time_dt:TIMESTAMP,office_location:STRING,surname:STRING>,name:STRING,org:STRUCT<name:STRING,ou_name:STRING,ou_uid:STRING,uid:STRING>,risk_level:STRING,risk_level_id:INT,risk_score:INT,type:STRING,type_id:INT,uid:STRING,uid_alt:STRING>,region:STRING,risk_level:STRING,risk_level_id:INT,risk_score:INT,subnet:STRING,subnet_uid:STRING,type:STRING,type_id:INT,uid:STRING,uid_alt:STRING,vlan_uid:STRING,vpc_uid:STRING,zone:STRING>,log_level:STRING,log_name:STRING,log_provider:STRING,log_version:STRING,logged_time:TIMESTAMP,logged_time_dt:TIMESTAMP,name:STRING,product:STRUCT<cpe_name:STRING,data_classification:STRUCT<category:STRING,category_id:INT,confidentiality:STRING,confidentiality_id:INT,policy:STRUCT<desc:STRING,group:STRUCT<desc:STRING,domain:STRING,name:STRING,privileges:ARRAY<STRING>,type:STRING,uid:STRING>,is_applied:BOOLEAN,name:STRING,uid:STRING,version:STRING>>,feature:STRUCT<name:STRING,uid:STRING,version:STRING>,lang:STRING,name:STRING,path:STRING,uid:STRING,url_string:STRING,vendor_name:STRING,version:STRING>,transmit_time:TIMESTAMP,transmit_time_dt:TIMESTAMP,uid:STRING,version:STRING>>,modified_time:TIMESTAMP,modified_time_dt:TIMESTAMP,original_time:STRING,processed_time:TIMESTAMP,processed_time_dt:TIMESTAMP,product:STRUCT<cpe_name:STRING,data_classification:STRUCT<category:STRING,category_id:INT,confidentiality:STRING,confidentiality_id:INT,policy:STRUCT<desc:STRING,group:STRUCT<desc:STRING,domain:STRING,name:STRING,privileges:ARRAY<STRING>,type:STRING,uid:STRING>,is_applied:BOOLEAN,name:STRING,uid:STRING,version:STRING>>,feature:STRUCT<name:STRING,uid:STRING,version:STRING>,lang:STRING,name:STRING,path:STRING,uid:STRING,url_string:STRING,vendor_name:STRING,version:STRING>,profiles:ARRAY<STRING>,sequence:INT,tenant_uid:STRING,uid:STRING,version:STRING>,observables ARRAY<STRUCT<name:STRING,reputation:STRUCT<base_score:FLOAT,provider:STRING,score:STRING,score_id:INT>,type:STRING,type_id:INT,value:STRING>>,osint ARRAY<STRUCT<answers:ARRAY<STRUCT<class:STRING,flag_ids:ARRAY<INT>,flags:ARRAY<STRING>,packet_uid:INT,rdata:STRING,ttl:INT,type:STRING>>,attacks:ARRAY<STRUCT<sub_technique:STRUCT<name:STRING,src_url:STRING,uid:STRING>,tactic:STRUCT<name:STRING,src_url:STRING,uid:STRING>,tactics:ARRAY<STRUCT<name:STRING,src_url:STRING,uid:STRING>>,technique:STRUCT<name:STRING,src_url:STRING,uid:STRING>,version:STRING>>,autonomous_system:STRUCT<name:STRING,number:INT>,comment:STRING,confidence:STRING,confidence_id:INT,email:STRUCT<cc:ARRAY<STRING>,data_classification:STRUCT<category:STRING,category_id:INT,confidentiality:STRING,confidentiality_id:INT,policy:STRUCT<desc:STRING,group:STRUCT<desc:STRING,domain:STRING,name:STRING,privileges:ARRAY<STRING>,type:STRING,uid:STRING>,is_applied:BOOLEAN,name:STRING,uid:STRING,version:STRING>>,delivered_to:STRING,from:STRING,message_uid:STRING,raw_header:STRING,reply_to:STRING,size:BIGINT,smtp_from:STRING,smtp_to:ARRAY<STRING>,subject:STRING,to:ARRAY<STRING>,uid:STRING,x_originating_ip:ARRAY<STRING>>,email_auth:STRUCT<dkim:STRING,dkim_domain:STRING,dkim_signature:STRING,dmarc:STRING,dmarc_override:STRING,dmarc_policy:STRING,spf:STRING>,kill_chain:ARRAY<STRUCT<phase:STRING,phase_id:INT>>,location:STRUCT<city:STRING,continent:STRING,coordinates:ARRAY<FLOAT>,country:STRING,desc:STRING,geohash:STRING,is_on_premises:BOOLEAN,isp:STRING,lat:FLOAT,long:FLOAT,postal_code:STRING,provider:STRING,region:STRING>,name:STRING,signatures:ARRAY<STRUCT<algorithm:STRING,algorithm_id:INT,certificate:STRUCT<created_time:TIMESTAMP,created_time_dt:TIMESTAMP,expiration_time:TIMESTAMP,expiration_time_dt:TIMESTAMP,fingerprints:ARRAY<STRUCT<algorithm:STRING,algorithm_id:INT,value:STRING>>,is_self_signed:BOOLEAN,issuer:STRING,serial_number:STRING,subject:STRING,uid:STRING,version:STRING>,created_time:TIMESTAMP,created_time_dt:TIMESTAMP,developer_uid:STRING,digest:STRUCT<algorithm:STRING,algorithm_id:INT,value:STRING>,state:STRING,state_id:INT>>,src_url:STRING,subdomains:ARRAY<STRING>,tlp:STRING,type:STRING,type_id:INT,uid:STRING,value:STRING,vendor_name:STRING,vulnerabilities:ARRAY<STRUCT<affected_code:ARRAY<STRUCT<end_line:INT,file:STRUCT<accessed_time:TIMESTAMP,accessed_time_dt:TIMESTAMP,accessor:STRUCT<account:STRUCT<labels:ARRAY<STRING>,name:STRING,type:STRING,type_id:INT,uid:STRING>,credential_uid:STRING,domain:STRING,email_addr:STRING,full_name:STRING,groups:ARRAY<STRUCT<desc:STRING,domain:STRING,name:STRING,privileges:ARRAY<STRING>,type:STRING,uid:STRING>>,ldap_person:STRUCT<cost_center:STRING,created_time:TIMESTAMP,created_time_dt:TIMESTAMP,deleted_time:TIMESTAMP,deleted_time_dt:TIMESTAMP,email_addrs:ARRAY<STRING>,employee_uid:STRING,given_name:STRING,hire_time:TIMESTAMP,hire_time_dt:TIMESTAMP,job_title:STRING,labels:ARRAY<STRING>,last_login_time:TIMESTAMP,last_login_time_dt:TIMESTAMP,ldap_cn:STRING,ldap_dn:STRING,leave_time:TIMESTAMP,leave_time_dt:TIMESTAMP,location:STRUCT<city:STRING,continent:STRING,coordinates:ARRAY<FLOAT>,country:STRING,desc:STRING,geohash:STRING,is_on_premises:BOOLEAN,isp:STRING,lat:FLOAT,long:FLOAT,postal_code:STRING,provider:STRING,region:STRING>,manager:VARIANT,modified_time:TIMESTAMP,modified_time_dt:TIMESTAMP,office_location:STRING,surname:STRING>,name:STRING,org:STRUCT<name:STRING,ou_name:STRING,ou_uid:STRING,uid:STRING>,risk_level:STRING,risk_level_id:INT,risk_score:INT,type:STRING,type_id:INT,uid:STRING,uid_alt:STRING>,attributes:INT,company_name:STRING,confidentiality:STRING,confidentiality_id:INT,created_time:TIMESTAMP,created_time_dt:TIMESTAMP,creator:STRUCT<account:STRUCT<labels:ARRAY<STRING>,name:STRING,type:STRING,type_id:INT,uid:STRING>,credential_uid:STRING,domain:STRING,email_addr:STRING,full_name:STRING,groups:ARRAY<STRUCT<desc:STRING,domain:STRING,name:STRING,privileges:ARRAY<STRING>,type:STRING,uid:STRING>>,ldap_person:STRUCT<cost_center:STRING,created_time:TIMESTAMP,created_time_dt:TIMESTAMP,deleted_time:TIMESTAMP,deleted_time_dt:TIMESTAMP,email_addrs:ARRAY<STRING>,employee_uid:STRING,given_name:STRING,hire_time:TIMESTAMP,hire_time_dt:TIMESTAMP,job_title:STRING,labels:ARRAY<STRING>,last_login_time:TIMESTAMP,last_login_time_dt:TIMESTAMP,ldap_cn:STRING,ldap_dn:STRING,leave_time:TIMESTAMP,leave_time_dt:TIMESTAMP,location:STRUCT<city:STRING,continent:STRING,coordinates:ARRAY<FLOAT>,country:STRING,desc:STRING,geohash:STRING,is_on_premises:BOOLEAN,isp:STRING,lat:FLOAT,long:FLOAT,postal_code:STRING,provider:STRING,region:STRING>,manager:VARIANT,modified_time:TIMESTAMP,modified_time_dt:TIMESTAMP,office_location:STRING,surname:STRING>,name:STRING,org:STRUCT<name:STRING,ou_name:STRING,ou_uid:STRING,uid:STRING>,risk_level:STRING,risk_level_id:INT,risk_score:INT,type:STRING,type_id:INT,uid:STRING,uid_alt:STRING>,data_classification:STRUCT<category:STRING,category_id:INT,confidentiality:STRING,confidentiality_id:INT,policy:STRUCT<desc:STRING,group:STRUCT<desc:STRING,domain:STRING,name:STRING,privileges:ARRAY<STRING>,type:STRING,uid:STRING>,is_applied:BOOLEAN,name:STRING,uid:STRING,version:STRING>>,desc:STRING,ext:STRING,hashes:ARRAY<STRUCT<algorithm:STRING,algorithm_id:INT,value:STRING>>,is_system:BOOLEAN,mime_type:STRING,modified_time:TIMESTAMP,modified_time_dt:TIMESTAMP,modifier:STRUCT<account:STRUCT<labels:ARRAY<STRING>,name:STRING,type:STRING,type_id:INT,uid:STRING>,credential_uid:STRING,domain:STRING,email_addr:STRING,full_name:STRING,groups:ARRAY<STRUCT<desc:STRING,domain:STRING,name:STRING,privileges:ARRAY<STRING>,type:STRING,uid:STRING>>,ldap_person:STRUCT<cost_center:STRING,created_time:TIMESTAMP,created_time_dt:TIMESTAMP,deleted_time:TIMESTAMP,deleted_time_dt:TIMESTAMP,email_addrs:ARRAY<STRING>,employee_uid:STRING,given_name:STRING,hire_time:TIMESTAMP,hire_time_dt:TIMESTAMP,job_title:STRING,labels:ARRAY<STRING>,last_login_time:TIMESTAMP,last_login_time_dt:TIMESTAMP,ldap_cn:STRING,ldap_dn:STRING,leave_time:TIMESTAMP,leave_time_dt:TIMESTAMP,location:STRUCT<city:STRING,continent:STRING,coordinates:ARRAY<FLOAT>,country:STRING,desc:STRING,geohash:STRING,is_on_premises:BOOLEAN,isp:STRING,lat:FLOAT,long:FLOAT,postal_code:STRING,provider:STRING,region:STRING>,manager:VARIANT,modified_time:TIMESTAMP,modified_time_dt:TIMESTAMP,office_location:STRING,surname:STRING>,name:STRING,org:STRUCT<name:STRING,ou_name:STRING,ou_uid:STRING,uid:STRING>,risk_level:STRING,risk_level_id:INT,risk_score:INT,type:STRING,type_id:INT,uid:STRING,uid_alt:STRING>,name:STRING,owner:STRUCT<account:STRUCT<labels:ARRAY<STRING>,name:STRING,type:STRING,type_id:INT,uid:STRING>,credential_uid:STRING,domain:STRING,email_addr:STRING,full_name:STRING,groups:ARRAY<STRUCT<desc:STRING,domain:STRING,name:STRING,privileges:ARRAY<STRING>,type:STRING,uid:STRING>>,ldap_person:STRUCT<cost_center:STRING,created_time:TIMESTAMP,created_time_dt:TIMESTAMP,deleted_time:TIMESTAMP,deleted_time_dt:TIMESTAMP,email_addrs:ARRAY<STRING>,employee_uid:STRING,given_name:STRING,hire_time:TIMESTAMP,hire_time_dt:TIMESTAMP,job_title:STRING,labels:ARRAY<STRING>,last_login_time:TIMESTAMP,last_login_time_dt:TIMESTAMP,ldap_cn:STRING,ldap_dn:STRING,leave_time:TIMESTAMP,leave_time_dt:TIMESTAMP,location:STRUCT<city:STRING,continent:STRING,coordinates:ARRAY<FLOAT>,country:STRING,desc:STRING,geohash:STRING,is_on_premises:BOOLEAN,isp:STRING,lat:FLOAT,long:FLOAT,postal_code:STRING,provider:STRING,region:STRING>,manager:VARIANT,modified_time:TIMESTAMP,modified_time_dt:TIMESTAMP,office_location:STRING,surname:STRING>,name:STRING,org:STRUCT<name:STRING,ou_name:STRING,ou_uid:STRING,uid:STRING>,risk_level:STRING,risk_level_id:INT,risk_score:INT,type:STRING,type_id:INT,uid:STRING,uid_alt:STRING>,parent_folder:STRING,path:STRING,product:STRUCT<cpe_name:STRING,data_classification:STRUCT<category:STRING,category_id:INT,confidentiality:STRING,confidentiality_id:INT,policy:STRUCT<desc:STRING,group:STRUCT<desc:STRING,domain:STRING,name:STRING,privileges:ARRAY<STRING>,type:STRING,uid:STRING>,is_applied:BOOLEAN,name:STRING,uid:STRING,version:STRING>>,feature:STRUCT<name:STRING,uid:STRING,version:STRING>,lang:STRING,name:STRING,path:STRING,uid:STRING,url_string:STRING,vendor_name:STRING,version:STRING>,security_descriptor:STRING,signature:STRUCT<algorithm:STRING,algorithm_id:INT,certificate:STRUCT<created_time:TIMESTAMP,created_time_dt:TIMESTAMP,expiration_time:TIMESTAMP,expiration_time_dt:TIMESTAMP,fingerprints:ARRAY<STRUCT<algorithm:STRING,algorithm_id:INT,value:STRING>>,is_self_signed:BOOLEAN,issuer:STRING,serial_number:STRING,subject:STRING,uid:STRING,version:STRING>,created_time:TIMESTAMP,created_time_dt:TIMESTAMP,developer_uid:STRING,digest:STRUCT<algorithm:STRING,algorithm_id:INT,value:STRING>,state:STRING,state_id:INT>,size:BIGINT,type:STRING,type_id:INT,uid:STRING,version:STRING,xattributes:VARIANT>,owner:STRUCT<account:STRUCT<labels:ARRAY<STRING>,name:STRING,type:STRING,type_id:INT,uid:STRING>,credential_uid:STRING,domain:STRING,email_addr:STRING,full_name:STRING,groups:ARRAY<STRUCT<desc:STRING,domain:STRING,name:STRING,privileges:ARRAY<STRING>,type:STRING,uid:STRING>>,ldap_person:STRUCT<cost_center:STRING,created_time:TIMESTAMP,created_time_dt:TIMESTAMP,deleted_time:TIMESTAMP,deleted_time_dt:TIMESTAMP,email_addrs:ARRAY<STRING>,employee_uid:STRING,given_name:STRING,hire_time:TIMESTAMP,hire_time_dt:TIMESTAMP,job_title:STRING,labels:ARRAY<STRING>,last_login_time:TIMESTAMP,last_login_time_dt:TIMESTAMP,ldap_cn:STRING,ldap_dn:STRING,leave_time:TIMESTAMP,leave_time_dt:TIMESTAMP,location:STRUCT<city:STRING,continent:STRING,coordinates:ARRAY<FLOAT>,country:STRING,desc:STRING,geohash:STRING,is_on_premises:BOOLEAN,isp:STRING,lat:FLOAT,long:FLOAT,postal_code:STRING,provider:STRING,region:STRING>,manager:VARIANT,modified_time:TIMESTAMP,modified_time_dt:TIMESTAMP,office_location:STRING,surname:STRING>,name:STRING,org:STRUCT<name:STRING,ou_name:STRING,ou_uid:STRING,uid:STRING>,risk_level:STRING,risk_level_id:INT,risk_score:INT,type:STRING,type_id:INT,uid:STRING,uid_alt:STRING>,remediation:STRUCT<desc:STRING,kb_article_list:ARRAY<STRUCT<avg_timespan:STRUCT<duration:BIGINT,duration_days:INT,duration_hours:INT,duration_mins:INT,duration_months:INT,duration_secs:INT,duration_weeks:INT,duration_years:INT,type:STRING,type_id:INT>,bulletin:STRING,classification:STRING,created_time:TIMESTAMP,created_time_dt:TIMESTAMP,install_state:STRING,install_state_id:INT,is_superseded:BOOLEAN,os:STRUCT<build:STRING,country:STRING,cpe_name:STRING,cpu_bits:INT,edition:STRING,lang:STRING,name:STRING,sp_name:STRING,sp_ver:INT,type:STRING,type_id:INT,version:STRING>,product:STRUCT<cpe_name:STRING,data_classification:STRUCT<category:STRING,category_id:INT,confidentiality:STRING,confidentiality_id:INT,policy:STRUCT<desc:STRING,group:STRUCT<desc:STRING,domain:STRING,name:STRING,privileges:ARRAY<STRING>,type:STRING,uid:STRING>,is_applied:BOOLEAN,name:STRING,uid:STRING,version:STRING>>,feature:STRUCT<name:STRING,uid:STRING,version:STRING>,lang:STRING,name:STRING,path:STRING,uid:STRING,url_string:STRING,vendor_name:STRING,version:STRING>,severity:STRING,size:BIGINT,src_url:STRING,title:STRING,uid:STRING>>,kb_articles:ARRAY<STRING>,references:ARRAY<STRING>>,start_line:INT>>,affected_packages:ARRAY<STRUCT<architecture:STRING,cpe_name:STRING,epoch:INT,fixed_in_version:STRING,hash:STRUCT<algorithm:STRING,algorithm_id:INT,value:STRING>,license:STRING,name:STRING,package_manager:STRING,path:STRING,purl:STRING,release:STRING,remediation:STRUCT<desc:STRING,kb_article_list:ARRAY<STRUCT<avg_timespan:STRUCT<duration:BIGINT,duration_days:INT,duration_hours:INT,duration_mins:INT,duration_months:INT,duration_secs:INT,duration_weeks:INT,duration_years:INT,type:STRING,type_id:INT>,bulletin:STRING,classification:STRING,created_time:TIMESTAMP,created_time_dt:TIMESTAMP,install_state:STRING,install_state_id:INT,is_superseded:BOOLEAN,os:STRUCT<build:STRING,country:STRING,cpe_name:STRING,cpu_bits:INT,edition:STRING,lang:STRING,name:STRING,sp_name:STRING,sp_ver:INT,type:STRING,type_id:INT,version:STRING>,product:STRUCT<cpe_name:STRING,data_classification:STRUCT<category:STRING,category_id:INT,confidentiality:STRING,confidentiality_id:INT,policy:STRUCT<desc:STRING,group:STRUCT<desc:STRING,domain:STRING,name:STRING,privileges:ARRAY<STRING>,type:STRING,uid:STRING>,is_applied:BOOLEAN,name:STRING,uid:STRING,version:STRING>>,feature:STRUCT<name:STRING,uid:STRING,version:STRING>,lang:STRING,name:STRING,path:STRING,uid:STRING,url_string:STRING,vendor_name:STRING,version:STRING>,severity:STRING,size:BIGINT,src_url:STRING,title:STRING,uid:STRING>>,kb_articles:ARRAY<STRING>,references:ARRAY<STRING>>,type:STRING,type_id:INT,vendor_name:STRING,version:STRING>>,cve:STRUCT<created_time:TIMESTAMP,created_time_dt:TIMESTAMP,cvss:ARRAY<STRUCT<base_score:FLOAT,depth:STRING,metrics:ARRAY<STRUCT<name:STRING,value:STRING>>,overall_score:FLOAT,severity:STRING,vector_string:STRING,version:STRING>>,cwe:STRUCT<caption:STRING,src_url:STRING,uid:STRING>,cwe_uid:STRING,cwe_url:STRING,desc:STRING,epss:STRUCT<created_time:TIMESTAMP,created_time_dt:TIMESTAMP,percentile:FLOAT,score:STRING,version:STRING>,modified_time:TIMESTAMP,modified_time_dt:TIMESTAMP,product:STRUCT<cpe_name:STRING,data_classification:STRUCT<category:STRING,category_id:INT,confidentiality:STRING,confidentiality_id:INT,policy:STRUCT<desc:STRING,group:STRUCT<desc:STRING,domain:STRING,name:STRING,privileges:ARRAY<STRING>,type:STRING,uid:STRING>,is_applied:BOOLEAN,name:STRING,uid:STRING,version:STRING>>,feature:STRUCT<name:STRING,uid:STRING,version:STRING>,lang:STRING,name:STRING,path:STRING,uid:STRING,url_string:STRING,vendor_name:STRING,version:STRING>,references:ARRAY<STRING>,title:STRING,type:STRING,uid:STRING>,cwe:STRUCT<caption:STRING,src_url:STRING,uid:STRING>,desc:STRING,first_seen_time:TIMESTAMP,first_seen_time_dt:TIMESTAMP,fix_available:BOOLEAN,is_exploit_available:BOOLEAN,is_fix_available:BOOLEAN,kb_article_list:ARRAY<STRUCT<avg_timespan:STRUCT<duration:BIGINT,duration_days:INT,duration_hours:INT,duration_mins:INT,duration_months:INT,duration_secs:INT,duration_weeks:INT,duration_years:INT,type:STRING,type_id:INT>,bulletin:STRING,classification:STRING,created_time:TIMESTAMP,created_time_dt:TIMESTAMP,install_state:STRING,install_state_id:INT,is_superseded:BOOLEAN,os:STRUCT<build:STRING,country:STRING,cpe_name:STRING,cpu_bits:INT,edition:STRING,lang:STRING,name:STRING,sp_name:STRING,sp_ver:INT,type:STRING,type_id:INT,version:STRING>,product:STRUCT<cpe_name:STRING,data_classification:STRUCT<category:STRING,category_id:INT,confidentiality:STRING,confidentiality_id:INT,policy:STRUCT<desc:STRING,group:STRUCT<desc:STRING,domain:STRING,name:STRING,privileges:ARRAY<STRING>,type:STRING,uid:STRING>,is_applied:BOOLEAN,name:STRING,uid:STRING,version:STRING>>,feature:STRUCT<name:STRING,uid:STRING,version:STRING>,lang:STRING,name:STRING,path:STRING,uid:STRING,url_string:STRING,vendor_name:STRING,version:STRING>,severity:STRING,size:BIGINT,src_url:STRING,title:STRING,uid:STRING>>,kb_articles:ARRAY<STRING>,last_seen_time:TIMESTAMP,last_seen_time_dt:TIMESTAMP,packages:ARRAY<STRUCT<architecture:STRING,cpe_name:STRING,epoch:INT,hash:STRUCT<algorithm:STRING,algorithm_id:INT,value:STRING>,license:STRING,name:STRING,purl:STRING,release:STRING,type:STRING,type_id:INT,vendor_name:STRING,version:STRING>>,references:ARRAY<STRING>,related_vulnerabilities:ARRAY<STRING>,remediation:STRUCT<desc:STRING,kb_article_list:ARRAY<STRUCT<avg_timespan:STRUCT<duration:BIGINT,duration_days:INT,duration_hours:INT,duration_mins:INT,duration_months:INT,duration_secs:INT,duration_weeks:INT,duration_years:INT,type:STRING,type_id:INT>,bulletin:STRING,classification:STRING,created_time:TIMESTAMP,created_time_dt:TIMESTAMP,install_state:STRING,install_state_id:INT,is_superseded:BOOLEAN,os:STRUCT<build:STRING,country:STRING,cpe_name:STRING,cpu_bits:INT,edition:STRING,lang:STRING,name:STRING,sp_name:STRING,sp_ver:INT,type:STRING,type_id:INT,version:STRING>,product:STRUCT<cpe_name:STRING,data_classification:STRUCT<category:STRING,category_id:INT,confidentiality:STRING,confidentiality_id:INT,policy:STRUCT<desc:STRING,group:STRUCT<desc:STRING,domain:STRING,name:STRING,privileges:ARRAY<STRING>,type:STRING,uid:STRING>,is_applied:BOOLEAN,name:STRING,uid:STRING,version:STRING>>,feature:STRUCT<name:STRING,uid:STRING,version:STRING>,lang:STRING,name:STRING,path:STRING,uid:STRING,url_string:STRING,vendor_name:STRING,version:STRING>,severity:STRING,size:BIGINT,src_url:STRING,title:STRING,uid:STRING>>,kb_articles:ARRAY<STRING>,references:ARRAY<STRING>>,severity:STRING,title:STRING,vendor_name:STRING>>,whois:STRUCT<autonomous_system:STRUCT<name:STRING,number:INT>,created_time:TIMESTAMP,created_time_dt:TIMESTAMP,dnssec_status:STRING,dnssec_status_id:INT,domain:STRING,domain_contacts:ARRAY<STRUCT<email_addr:STRING,location:STRUCT<city:STRING,continent:STRING,coordinates:ARRAY<FLOAT>,country:STRING,desc:STRING,geohash:STRING,is_on_premises:BOOLEAN,isp:STRING,lat:FLOAT,long:FLOAT,postal_code:STRING,provider:STRING,region:STRING>,name:STRING,phone_number:STRING,type:STRING,type_id:INT,uid:STRING>>,email_addr:STRING,last_seen_time:TIMESTAMP,last_seen_time_dt:TIMESTAMP,name_servers:ARRAY<STRING>,phone_number:STRING,registrar:STRING,status:STRING,subdomains:ARRAY<STRING>,subnet:STRING>>>,raw_data STRING,resources ARRAY<STRUCT<agent_list:ARRAY<STRUCT<name:STRING,policies:ARRAY<STRUCT<desc:STRING,group:STRUCT<desc:STRING,domain:STRING,name:STRING,privileges:ARRAY<STRING>,type:STRING,uid:STRING>,is_applied:BOOLEAN,name:STRING,uid:STRING,version:STRING>>,type:STRING,type_id:INT,uid:STRING,uid_alt:STRING,vendor_name:STRING,version:STRING>>,cloud_partition:STRING,criticality:STRING,data:VARIANT,data_classification:STRUCT<category:STRING,category_id:INT,confidentiality:STRING,confidentiality_id:INT,policy:STRUCT<desc:STRING,group:STRUCT<desc:STRING,domain:STRING,name:STRING,privileges:ARRAY<STRING>,type:STRING,uid:STRING>,is_applied:BOOLEAN,name:STRING,uid:STRING,version:STRING>>,group:STRUCT<desc:STRING,domain:STRING,name:STRING,privileges:ARRAY<STRING>,type:STRING,uid:STRING>,labels:ARRAY<STRING>,name:STRING,namespace:STRING,owner:STRUCT<account:STRUCT<labels:ARRAY<STRING>,name:STRING,type:STRING,type_id:INT,uid:STRING>,credential_uid:STRING,domain:STRING,email_addr:STRING,full_name:STRING,groups:ARRAY<STRUCT<desc:STRING,domain:STRING,name:STRING,privileges:ARRAY<STRING>,type:STRING,uid:STRING>>,ldap_person:STRUCT<cost_center:STRING,created_time:TIMESTAMP,created_time_dt:TIMESTAMP,deleted_time:TIMESTAMP,deleted_time_dt:TIMESTAMP,email_addrs:ARRAY<STRING>,employee_uid:STRING,given_name:STRING,hire_time:TIMESTAMP,hire_time_dt:TIMESTAMP,job_title:STRING,labels:ARRAY<STRING>,last_login_time:TIMESTAMP,last_login_time_dt:TIMESTAMP,ldap_cn:STRING,ldap_dn:STRING,leave_time:TIMESTAMP,leave_time_dt:TIMESTAMP,location:STRUCT<city:STRING,continent:STRING,coordinates:ARRAY<FLOAT>,country:STRING,desc:STRING,geohash:STRING,is_on_premises:BOOLEAN,isp:STRING,lat:FLOAT,long:FLOAT,postal_code:STRING,provider:STRING,region:STRING>,manager:VARIANT,modified_time:TIMESTAMP,modified_time_dt:TIMESTAMP,office_location:STRING,surname:STRING>,name:STRING,org:STRUCT<name:STRING,ou_name:STRING,ou_uid:STRING,uid:STRING>,risk_level:STRING,risk_level_id:INT,risk_score:INT,type:STRING,type_id:INT,uid:STRING,uid_alt:STRING>,region:STRING,type:STRING,uid:STRING,version:STRING>>,severity STRING,severity_id INT,src_endpoint STRUCT<agent_list:ARRAY<STRUCT<name:STRING,policies:ARRAY<STRUCT<desc:STRING,group:STRUCT<desc:STRING,domain:STRING,name:STRING,privileges:ARRAY<STRING>,type:STRING,uid:STRING>,is_applied:BOOLEAN,name:STRING,uid:STRING,version:STRING>>,type:STRING,type_id:INT,uid:STRING,uid_alt:STRING,vendor_name:STRING,version:STRING>>,autonomous_system:STRUCT<name:STRING,number:INT>,container:STRUCT<hash:STRUCT<algorithm:STRING,algorithm_id:INT,value:STRING>,image:STRUCT<labels:ARRAY<STRING>,name:STRING,path:STRING,tag:STRING,uid:STRING>,name:STRING,network_driver:STRING,orchestrator:STRING,pod_uuid:STRING,runtime:STRING,size:BIGINT,tag:STRING,uid:STRING>,domain:STRING,hostname:STRING,hw_info:STRUCT<bios_date:STRING,bios_manufacturer:STRING,bios_ver:STRING,chassis:STRING,cpu_bits:INT,cpu_cores:INT,cpu_count:INT,cpu_speed:INT,cpu_type:STRING,desktop_display:STRUCT<color_depth:INT,physical_height:INT,physical_orientation:INT,physical_width:INT,scale_factor:INT>,keyboard_info:STRUCT<function_keys:INT,ime:STRING,keyboard_layout:STRING,keyboard_subtype:INT,keyboard_type:STRING>,ram_size:INT,serial_number:STRING>,instance_uid:STRING,interface_name:STRING,interface_uid:STRING,intermediate_ips:ARRAY<STRING>,ip:STRING,location:STRUCT<city:STRING,continent:STRING,coordinates:ARRAY<FLOAT>,country:STRING,desc:STRING,geohash:STRING,is_on_premises:BOOLEAN,isp:STRING,lat:FLOAT,long:FLOAT,postal_code:STRING,provider:STRING,region:STRING>,mac:STRING,name:STRING,namespace_pid:INT,os:STRUCT<build:STRING,country:STRING,cpe_name:STRING,cpu_bits:INT,edition:STRING,lang:STRING,name:STRING,sp_name:STRING,sp_ver:INT,type:STRING,type_id:INT,version:STRING>,owner:STRUCT<account:STRUCT<labels:ARRAY<STRING>,name:STRING,type:STRING,type_id:INT,uid:STRING>,credential_uid:STRING,domain:STRING,email_addr:STRING,full_name:STRING,groups:ARRAY<STRUCT<desc:STRING,domain:STRING,name:STRING,privileges:ARRAY<STRING>,type:STRING,uid:STRING>>,ldap_person:STRUCT<cost_center:STRING,created_time:TIMESTAMP,created_time_dt:TIMESTAMP,deleted_time:TIMESTAMP,deleted_time_dt:TIMESTAMP,email_addrs:ARRAY<STRING>,employee_uid:STRING,given_name:STRING,hire_time:TIMESTAMP,hire_time_dt:TIMESTAMP,job_title:STRING,labels:ARRAY<STRING>,last_login_time:TIMESTAMP,last_login_time_dt:TIMESTAMP,ldap_cn:STRING,ldap_dn:STRING,leave_time:TIMESTAMP,leave_time_dt:TIMESTAMP,location:STRUCT<city:STRING,continent:STRING,coordinates:ARRAY<FLOAT>,country:STRING,desc:STRING,geohash:STRING,is_on_premises:BOOLEAN,isp:STRING,lat:FLOAT,long:FLOAT,postal_code:STRING,provider:STRING,region:STRING>,manager:VARIANT,modified_time:TIMESTAMP,modified_time_dt:TIMESTAMP,office_location:STRING,surname:STRING>,name:STRING,org:STRUCT<name:STRING,ou_name:STRING,ou_uid:STRING,uid:STRING>,risk_level:STRING,risk_level_id:INT,risk_score:INT,type:STRING,type_id:INT,uid:STRING,uid_alt:STRING>,port:INT,proxy_endpoint:STRUCT<agent_list:ARRAY<STRUCT<name:STRING,policies:ARRAY<STRUCT<desc:STRING,group:STRUCT<desc:STRING,domain:STRING,name:STRING,privileges:ARRAY<STRING>,type:STRING,uid:STRING>,is_applied:BOOLEAN,name:STRING,uid:STRING,version:STRING>>,type:STRING,type_id:INT,uid:STRING,uid_alt:STRING,vendor_name:STRING,version:STRING>>,autonomous_system:STRUCT<name:STRING,number:INT>,container:STRUCT<hash:STRUCT<algorithm:STRING,algorithm_id:INT,value:STRING>,image:STRUCT<labels:ARRAY<STRING>,name:STRING,path:STRING,tag:STRING,uid:STRING>,name:STRING,network_driver:STRING,orchestrator:STRING,pod_uuid:STRING,runtime:STRING,size:BIGINT,tag:STRING,uid:STRING>,domain:STRING,hostname:STRING,hw_info:STRUCT<bios_date:STRING,bios_manufacturer:STRING,bios_ver:STRING,chassis:STRING,cpu_bits:INT,cpu_cores:INT,cpu_count:INT,cpu_speed:INT,cpu_type:STRING,desktop_display:STRUCT<color_depth:INT,physical_height:INT,physical_orientation:INT,physical_width:INT,scale_factor:INT>,keyboard_info:STRUCT<function_keys:INT,ime:STRING,keyboard_layout:STRING,keyboard_subtype:INT,keyboard_type:STRING>,ram_size:INT,serial_number:STRING>,instance_uid:STRING,interface_name:STRING,interface_uid:STRING,intermediate_ips:ARRAY<STRING>,ip:STRING,location:STRUCT<city:STRING,continent:STRING,coordinates:ARRAY<FLOAT>,country:STRING,desc:STRING,geohash:STRING,is_on_premises:BOOLEAN,isp:STRING,lat:FLOAT,long:FLOAT,postal_code:STRING,provider:STRING,region:STRING>,mac:STRING,name:STRING,namespace_pid:INT,os:STRUCT<build:STRING,country:STRING,cpe_name:STRING,cpu_bits:INT,edition:STRING,lang:STRING,name:STRING,sp_name:STRING,sp_ver:INT,type:STRING,type_id:INT,version:STRING>,owner:STRUCT<account:STRUCT<labels:ARRAY<STRING>,name:STRING,type:STRING,type_id:INT,uid:STRING>,credential_uid:STRING,domain:STRING,email_addr:STRING,full_name:STRING,groups:ARRAY<STRUCT<desc:STRING,domain:STRING,name:STRING,privileges:ARRAY<STRING>,type:STRING,uid:STRING>>,ldap_person:STRUCT<cost_center:STRING,created_time:TIMESTAMP,created_time_dt:TIMESTAMP,deleted_time:TIMESTAMP,deleted_time_dt:TIMESTAMP,email_addrs:ARRAY<STRING>,employee_uid:STRING,given_name:STRING,hire_time:TIMESTAMP,hire_time_dt:TIMESTAMP,job_title:STRING,labels:ARRAY<STRING>,last_login_time:TIMESTAMP,last_login_time_dt:TIMESTAMP,ldap_cn:STRING,ldap_dn:STRING,leave_time:TIMESTAMP,leave_time_dt:TIMESTAMP,location:STRUCT<city:STRING,continent:STRING,coordinates:ARRAY<FLOAT>,country:STRING,desc:STRING,geohash:STRING,is_on_premises:BOOLEAN,isp:STRING,lat:FLOAT,long:FLOAT,postal_code:STRING,provider:STRING,region:STRING>,manager:VARIANT,modified_time:TIMESTAMP,modified_time_dt:TIMESTAMP,office_location:STRING,surname:STRING>,name:STRING,org:STRUCT<name:STRING,ou_name:STRING,ou_uid:STRING,uid:STRING>,risk_level:STRING,risk_level_id:INT,risk_score:INT,type:STRING,type_id:INT,uid:STRING,uid_alt:STRING>,port:INT,proxy_endpoint:VARIANT,subnet_uid:STRING,svc_name:STRING,type:STRING,type_id:INT,uid:STRING,vlan_uid:STRING,vpc_uid:STRING,zone:STRING>,subnet_uid:STRING,svc_name:STRING,type:STRING,type_id:INT,uid:STRING,vlan_uid:STRING,vpc_uid:STRING,zone:STRING>,start_time TIMESTAMP,start_time_dt TIMESTAMP,status STRING,status_code STRING,status_detail STRING,status_id INT,time_dt TIMESTAMP,timezone_offset INT,type_name STRING,type_uid BIGINT"
silver:
  preTransform:
    - name: aws_sec_lake_s3_data
      filter: ""
      postFilter: ""
      fields:
      - name: rescued_data_json
        expr: parse_json(_rescued_data)
    
      utils:
        unreferencedColumns:
          preserve: true
  transform:
    - name: aws_sec_lake_s3_data
      filter: ""
      postFilter: ""
      fields:
      - name: api
        from: api
      - name: activity_name
        from: activity_name
      - name: activity_id
        from: activity_id
      - name: actor
        from: actor
      - name: category_name
        from: category_name
      - name: category_uid
        from: category_uid
      - name: class_name
        from: class_name
      - name: class_uid
        from: class_uid
      - name: cloud
        from: cloud
      - name: count
        from: count
      - name: dst_endpoint
        from: dst_endpoint
      - name: duration
        from: duration
      - name: end_time_dt
        from: end_time_dt
      - name: end_time
        from: end_time
      - name: enrichments
        from: enrichments
      - name: time
        expr: timestamp_millis(time)
      - name: time_dt
        from: time_dt
      - name: http_request
        from: http_request
      - name: message
        from: message
      - name: metadata
        from: metadata
      - name: osint
        from: osint
      - name: observables
        from: observables
      - name: raw_data
        from: raw_data
      - name: resources
        from: resources
      - name: severity
        from: severity
      - name: severity_id
        from: severity_id
      - name: src_endpoint
        from: src_endpoint
      - name: start_time
        from: start_time
      - name: start_time_dt
        from: start_time_dt
      - name: status
        from: status
      - name: status_code
        from: status_code
      - name: status_detail
        from: status_detail
      - name: status_id
        from: status_id
      - name: timezone_offset
        from: timezone_offset
      - name: type_uid
        from: type_uid
      - name: type_name
        from: type_name
      - name: unmapped
        expr: parse_json(to_json(unmapped))
      utils:
        unreferencedColumns:
          preserve: true
          omitColumns: [_rescued_data]
gold:
  - name: api_activity
    input: aws_sec_lake_s3_data
    filter: ""
    postFilter: ""
    fields:
      - name: api
        from: api
      - name: activity_name
        from: activity_name
      - name: activity_id
        from: activity_id
      - name: actor
        from: actor
      - name: category_name
        from: category_name
      - name: category_uid
        from: category_uid
      - name: class_name
        from: class_name
      - name: class_uid
        from: class_uid
      - name: cloud
        from: cloud
      - name: count
        from: count
      - name: dst_endpoint
        from: dst_endpoint
      - name: duration
        from: duration
      - name: end_time_dt
        from: end_time_dt
      - name: end_time
        from: end_time
      - name: enrichments
        from: enrichments
      - name: time
        from: time
      - name: time_dt
        from: time_dt
      - name: http_request
        from: http_request
      - name: message
        from: message
      - name: metadata
        from: metadata
      - name: osint
        from: osint
      - name: observables
        from: observables
      - name: raw_data
        from: raw_data
      - name: resources
        from: resources
      - name: severity
        from: severity
      - name: severity_id
        from: severity_id
      - name: src_endpoint
        from: src_endpoint
      - name: start_time
        from: start_time
      - name: start_time_dt
        from: start_time_dt
      - name: status
        from: status
      - name: status_code
        from: status_code
      - name: status_detail
        from: status_detail
      - name: status_id
        from: status_id
      - name: timezone_offset
        from: timezone_offset
      - name: type_uid
        from: type_uid
      - name: type_name
        from: type_name
      - name: unmapped
        from: unmapped
    utils:
      unreferencedColumns:
        preserve: false
